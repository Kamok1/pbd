input {
  generator {
    count => 1
    lines => [
      "2024-01-20 08:45:12 [INFO] TX-ID: {99421} | User: <admin> | Amount: 250.00 USD | Region: EU-West",
      "2024-01-20 08:46:05 [WARN] TX-ID: {99422} | User: <jan_k> | Amount: 45.99 USD | Region: PL-Warsaw",
      "2024-01-20 08:50:00 [ERROR] TX-ID: {99423} | User: <unknown> | Amount: 0.00 USD | Region: N/A",
      "2024-01-20 08:51:15 [INFO] TX-ID: {99424} | User: <system_process> | Amount: 1500.00 EUR | Region: DE-Berlin",
      "2024-01-20 08:52:22 [INFO] TX-ID: {99425} | User: <alice_wonder> | Amount: 12.50 GBP | Region: UK-London",
      "2024-01-20 08:53:10 [WARN] TX-ID: {99426} | User: <script_bot> | Amount: 999.99 USD | Region: US-East",
      "2024-01-20 08:54:01 [INFO] TX-ID: {99427} | User: <manager_01> | Amount: 5000.00 PLN | Region: PL-Krakow",
      "2024-01-20 08:55:45 [ERROR] TX-ID: {99428} | User: <hacker_xx> | Amount: 0.01 BTC | Region: RU-Moscow",
      "2024-01-20 08:56:12 [INFO] TX-ID: {99429} | User: <admin> | Amount: 120.00 USD | Region: EU-West",
      "2024-01-20 08:57:33 [FATAL] TX-ID: {99430} | User: <root> | Amount: 0.00 USD | Region: SYSTEM",
      "2024-01-20 08:58:19 [INFO] TX-ID: {99431} | User: <customer_service> | Amount: 45.20 EUR | Region: FR-Paris",
      "2024-01-20 08:59:00 [INFO] TX-ID: {99432} | User: <jan_k> | Amount: 12.99 USD | Region: PL-Warsaw",
      "2024-01-20 09:00:11 [WARN] TX-ID: {99433} | User: <guest> | Amount: 0.00 USD | Region: N/A",
      "2024-01-20 09:01:25 [INFO] TX-ID: {99434} | User: <bob_builder> | Amount: 350.75 USD | Region: US-West",
      "2024-01-20 09:02:40 [INFO] TX-ID: {99435} | User: <sales_rept> | Amount: 12500.00 JPY | Region: JP-Tokyo",
      "2024-01-20 09:03:55 [ERROR] TX-ID: {99436} | User: <sql_injector> | Amount: -1.00 USD | Region: UNKNOWN",
      "2024-01-20 09:04:10 [INFO] TX-ID: {99437} | User: <admin> | Amount: 100.00 USD | Region: EU-West",
      "2024-01-20 09:05:05 [INFO] TX-ID: {99438} | User: <inventory_svc> | Amount: 33.33 EUR | Region: DE-Munich",
      "2024-01-20 09:06:18 [WARN] TX-ID: {99439} | User: <latency_check> | Amount: 0.00 USD | Region: Global",
      "2024-01-20 09:07:22 [INFO] TX-ID: {99440} | User: <charlie_d> | Amount: 75.50 CAD | Region: CA-Toronto",
      "2024-01-20 09:08:44 [INFO] TX-ID: {99441} | User: <super_user> | Amount: 9999.99 USD | Region: US-Central",
      "2024-01-20 09:09:59 [INFO] TX-ID: {99442} | User: <backup_daemon> | Amount: 0.00 USD | Region: Local",
      "2024-01-20 09:10:30 [ERROR] TX-ID: {99443} | User: <unknown> | Amount: 500.00 USD | Region: CN-Beijing",
      "2024-01-20 09:11:15 [INFO] TX-ID: {99444} | User: <jan_k> | Amount: 88.00 PLN | Region: PL-Warsaw",
      "2024-01-20 09:12:00 [INFO] TX-ID: {99445} | User: <qa_tester> | Amount: 1.23 USD | Region: IN-Mumbai",
      "2024-01-20 09:13:45 [WARN] TX-ID: {99446} | User: <load_balancer> | Amount: 0.00 USD | Region: Cloud",
      "2024-01-20 09:14:20 [INFO] TX-ID: {99447} | User: <finance_dept> | Amount: 1234.56 CHF | Region: CH-Zurich",
      "2024-01-20 09:15:10 [INFO] TX-ID: {99448} | User: <admin> | Amount: 200.00 USD | Region: EU-West",
      "2024-01-20 09:16:55 [FATAL] TX-ID: {99449} | User: <kernel_panic> | Amount: 0.00 USD | Region: CORE",
      "2024-01-20 09:17:33 [INFO] TX-ID: {99450} | User: <devops_lead> | Amount: 55.55 USD | Region: US-East",
      "2024-01-20 09:18:22 [INFO] TX-ID: {99451} | User: <hr_manager> | Amount: 120.00 GBP | Region: UK-Manchester",
      "2024-01-20 09:19:11 [WARN] TX-ID: {99452} | User: <temp_user_12> | Amount: 10.00 USD | Region: N/A",
      "2024-01-20 09:20:05 [INFO] TX-ID: {99453} | User: <logistic_ai> | Amount: 5600.00 CNY | Region: CN-Shanghai",
      "2024-01-20 09:21:48 [ERROR] TX-ID: {99454} | User: <malware_sig> | Amount: 666.00 USD | Region: DarkWeb",
      "2024-01-20 09:22:30 [INFO] TX-ID: {99455} | User: <support_l1> | Amount: 25.00 USD | Region: PH-Manila",
      "2024-01-20 09:23:15 [INFO] TX-ID: {99456} | User: <support_l2> | Amount: 50.00 USD | Region: PH-Manila",
      "2024-01-20 09:24:00 [INFO] TX-ID: {99457} | User: <jan_k> | Amount: 200.00 PLN | Region: PL-Gdansk",
      "2024-01-20 09:25:50 [INFO] TX-ID: {99458} | User: <ceo_ipad> | Amount: 10000.00 USD | Region: US-West",
      "2024-01-20 09:26:40 [WARN] TX-ID: {99459} | User: <monitor_sys> | Amount: 0.00 USD | Region: AWS-Region",
      "2024-01-20 09:27:35 [INFO] TX-ID: {99460} | User: <warehouse_1> | Amount: 450.00 EUR | Region: ES-Madrid",
      "2024-01-20 09:28:20 [INFO] TX-ID: {99461} | User: <warehouse_2> | Amount: 320.00 EUR | Region: IT-Rome",
      "2024-01-20 09:29:10 [ERROR] TX-ID: {99462} | User: <null_ptr> | Amount: 0.00 USD | Region: Exception",
      "2024-01-20 09:30:05 [INFO] TX-ID: {99463} | User: <legacy_api> | Amount: 12.00 USD | Region: US-North",
      "2024-01-20 09:31:00 [INFO] TX-ID: {99464} | User: <new_api_v2> | Amount: 14.50 USD | Region: US-North",
      "2024-01-20 09:32:45 [INFO] TX-ID: {99465} | User: <admin> | Amount: 5.00 USD | Region: EU-West",
      "2024-01-20 09:33:30 [INFO] TX-ID: {99466} | User: <data_eng> | Amount: 1024.00 USD | Region: Remote",
      "2024-01-20 09:34:15 [WARN] TX-ID: {99467} | User: <deprecated> | Amount: 0.00 USD | Region: Legacy-Server",
      "2024-01-20 09:35:00 [INFO] TX-ID: {99468} | User: <final_test> | Amount: 99.99 USD | Region: End-World",
      "2024-01-20 09:35:55 [INFO] TX-ID: {99469} | User: <last_user> | Amount: 1.00 USD | Region: Done"
    ]
  }
}
  
filter {
  grok {
    match => { "message" => "%{TIMESTAMP_ISO8601:timestamp} \[%{LOGLEVEL:level}\] TX-ID: \{%{NUMBER:tx_id}\} \| User: <%{DATA:username}> \| Amount: %{NUMBER:amount:float} %{WORD:currency} \| Region: %{GREEDYDATA:region}"    }
  }
  date {
    match => [ "timestamp", "yyyy-MM-dd HH:mm:ss" ]
    target => "@timestamp"
    timezone => "UTC"
  }
  mutate {
    remove_field => ["message", "sequence", "timestamp", "host", "@version"]
  }
}

output {
  elasticsearch {
    hosts => ["elasticsearch:9200"]
    index => "warehouse-logs"
  }
}